/*
 * doormat - http://jh3y.github.io/doormat
 *
 * @license MIT
 * @author jh3y
 * (c) 2016
 */
(function(){var e,t;t={CLASS:"dm",CURRENT_CLASS:"dm__pnl--crnt",SCROLLBUFFER:0,SNAPDURATION:250,SNAPTHRESHOLD:15,NEXT:"next",PREVIOUS:"previous",RESET:"reset"},e=window.Doormat=function(n){var o,r,i,s,O,T,l,S,f,R;if(s=document.querySelector("."+t.CLASS),!(this instanceof e))return new e(n);if(!s)throw Error("Doormat: Must pass an element instance");R=function(e,n){var o;return o=i.current,o.className=o.className.replace(t.CURRENT_CLASS,""),o.style.top=e===t.NEXT?-o.offsetHeight+"px":0,i.current=e===t.RESET?i.panels[0]:o[e+"ElementSibling"],i.current.className+=" "+t.CURRENT_CLASS},o=function(e){var n,o,r,O;for(O=0,o=0,n=s.offsetHeight;o<i.panels.length;)r=i.panels[o],r.style.display="block",r.style.minHeight=n+"px",r.style.top="0px",r.DOORMAT_HEIGHT=r.offsetHeight,o+1!==i.panels.length&&0!==t.SCROLLBUFFER&&(r.DOORMAT_HEIGHT=r.DOORMAT_HEIGHT+n*(t.SCROLLBUFFER/100)),r.DOORMAT_POS=O,O+=r.DOORMAT_HEIGHT,o++;return t.SNAPTHRESHOLDSIZE=n*(t.SNAPTHRESHOLD/100),document.body.style.height=O+"px",e?(window.scrollTo(0,0),R(t.RESET)):void 0},r=function(e,t){clearTimeout(e.TIMER),e.TIMER=setTimeout(e,t)},T=function(){var e,n,o;return e=i.current,o=window.scrollY||window.pageYOffset,l()&&o!==e.DOORMAT_POS?(e.style.transitionProperty="top",e.style.transitionDuration=t.SNAPTRANSITIONDURATION,n=function(){return e.style.transitionProperty=null,e.style.transitionDuration=null,e.removeEventListener("transitionend",n)},e.addEventListener("transitionend",n,!1),i.SNAP_BOTTOM?window.scrollTo(0,e.DOORMAT_POS+(e.offsetHeight-s.offsetHeight)):(e.style.top=-e.offsetHeight+"px",R(t.NEXT),window.scrollTo(0,i.current.DOORMAT_POS-(i.current.DOORMAT_HEIGHT-i.current.offsetHeight)))):void 0},l=function(){var e,n;return e=i.current,n=window.scrollY||window.pageYOffset,i.SNAP_TOP=n>e.offsetHeight+e.DOORMAT_POS-t.SNAPTHRESHOLDSIZE&&n<e.DOORMAT_POS+e.offsetHeight,i.SNAP_BOTTOM=n>e.DOORMAT_POS+e.offsetHeight-s.offsetHeight&&n<e.DOORMAT_POS+e.offsetHeight-s.offsetHeight+t.SNAPTHRESHOLDSIZE,i.SNAP_TOP||i.SNAP_BOTTOM},O=function(){var e,n;if(e=i.current,n=window.scrollY||window.pageYOffset,e.style.top=-(n-e.DOORMAT_POS)+"px",n>e.DOORMAT_HEIGHT+e.DOORMAT_POS){if(e.nextElementSibling)return R(t.NEXT)}else if(n<e.DOORMAT_POS){if(e.previousElementSibling)return R(t.PREVIOUS)}else if(l())return r(T,t.SNAPDURATION)},"onorientationchange"in window?window.onorientationchange=o:window.onresize=o,window.onscroll=O,i=this,i.el=s,i.panels=i.el.children;for(f in n)S=f.toUpperCase(),void 0!==t[S]&&(t[S]=n[f]),t.SNAPTRANSITIONDURATION=t.SNAPDURATION/1e3+"s";return i.current=i.panels[0],i.current.className+=" "+t.CURRENT_CLASS,o(),i}}).call(this);