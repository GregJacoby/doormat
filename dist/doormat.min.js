/*
 * doormat - http://jh3y.github.io/doormat
 *
 * @license MIT
 * @author jh3y
 * (c) 2016
 */
(function(){var e,n;n={CLASS:"dm",CURRENT_CLASS:"dm__pnl--crnt",SCROLLBUFFER:0,SNAPDURATION:250,SNAPTHRESHOLD:15,NEXT:"next",PREVIOUS:"previous",RESET:"reset"},e=window.Doormat=function(t){var r,i,o,O,s,T,l,S,a,R;if(O=document.querySelector("."+n.CLASS),!(this instanceof e))return new e(t);if(!O)throw Error("Doormat: Must pass an element instance");R=function(e,t){var r;return r=o.current,r.className=r.className.replace(n.CURRENT_CLASS,""),r.style.top=e===n.NEXT?-r.offsetHeight+"px":0,o.current=e===n.RESET?o.panels[0]:r[e+"ElementSibling"],o.current.className+=" "+n.CURRENT_CLASS},r=function(e){var t,r,i,O;O=0,r=0,t="onorientationchange"in window?screen.height:window.innerHeight,o.CLIENT_HEIGHT=t;for(;r<o.panels.length;)i=o.panels[r],i.style.display="block",i.style.minHeight=t+"px",i.style.top="0px",i.DOORMAT_HEIGHT=i.offsetHeight,r+1!==o.panels.length&&0!==n.SCROLLBUFFER&&(i.DOORMAT_HEIGHT=i.DOORMAT_HEIGHT+t*(n.SCROLLBUFFER/100)),i.DOORMAT_POS=O,O+=i.DOORMAT_HEIGHT,r++;return n.SNAPTHRESHOLDSIZE=t*(n.SNAPTHRESHOLD/100),document.body.style.height=O+"px",e?(window.scrollTo(0,0),R(n.RESET)):void 0},i=function(e,n){clearTimeout(e.TIMER),e.TIMER=setTimeout(e,n)},T=function(){var e,t,r;return e=o.current,r=window.scrollY||window.pageYOffset,l()&&r!==e.DOORMAT_POS?(e.style.transitionProperty="top",e.style.transitionDuration=n.SNAPTRANSITIONDURATION,t=function(){return e.style.transitionProperty=null,e.style.transitionDuration=null,e.removeEventListener("transitionend",t)},e.addEventListener("transitionend",t,!1),o.SNAP_BOTTOM?window.scrollTo(0,e.DOORMAT_POS+(e.offsetHeight-o.CLIENT_HEIGHT)):(e.style.top=-e.offsetHeight+"px",R(n.NEXT),window.scrollTo(0,o.current.DOORMAT_POS-(o.current.DOORMAT_HEIGHT-o.current.offsetHeight)))):void 0},l=function(){var e,t;return e=o.current,t=window.scrollY||window.pageYOffset,o.SNAP_TOP=t>e.offsetHeight+e.DOORMAT_POS-n.SNAPTHRESHOLDSIZE&&t<e.DOORMAT_POS+e.offsetHeight,o.SNAP_BOTTOM=t>e.DOORMAT_POS+e.offsetHeight-o.CLIENT_HEIGHT&&t<e.DOORMAT_POS+e.offsetHeight-o.CLIENT_HEIGHT+n.SNAPTHRESHOLDSIZE,o.SNAP_TOP||o.SNAP_BOTTOM},s=function(){var e,t;if(e=o.current,t=window.scrollY||window.pageYOffset,e.style.top=-(t-e.DOORMAT_POS)+"px",t>e.DOORMAT_HEIGHT+e.DOORMAT_POS){if(e.nextElementSibling)return R(n.NEXT)}else if(t<e.DOORMAT_POS){if(e.previousElementSibling)return R(n.PREVIOUS)}else if(l())return i(T,n.SNAPDURATION)},"onorientationchange"in window?window.onorientationchange=r:window.onresize=r,window.onscroll=s,o=this,o.el=O,o.panels=o.el.children;for(a in t)S=a.toUpperCase(),void 0!==n[S]&&(n[S]=t[a]),n.SNAPTRANSITIONDURATION=n.SNAPDURATION/1e3+"s";return o.current=o.panels[0],o.current.className+=" "+n.CURRENT_CLASS,r(),o}}).call(this);